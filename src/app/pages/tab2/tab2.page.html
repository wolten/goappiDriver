<ion-header translucent="true" class="ion-no-border">
  <ion-toolbar class="ion-text-left transparent">
    <ion-title color="pink">Orders Pending</ion-title>

    <ion-buttons slot="end">
      <ion-label color="pink" *ngIf="!usuario.status_drive"> Offline</ion-label>
      <ion-label color="success" *ngIf="usuario.status_drive"> Online </ion-label> &nbsp;
      <ion-toggle color="success" [checked]="usuario.status_drive" (ionChange)="changeDisponibilidad($event.detail)" #toggleDisponibilidad></ion-toggle>
      <ion-spinner name="lines-small" *ngIf="cargandoGeo"></ion-spinner>
    </ion-buttons>

  </ion-toolbar>
</ion-header>

<ion-content fullscreen="true" class="bg">
  <ion-progress-bar *ngIf="!loading" type="indeterminate"></ion-progress-bar>

  <!-- Refresher -->
  <ion-refresher slot="fixed" (ionRefresh)="recargar( $event )">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>


  <!-- CARGANDO USUARIO -->
  <ion-grid *ngIf="!loadingUsuario" class="ion-text-center">
    <!-- Crescent -->
    <ion-spinner name="crescent"></ion-spinner>
    <ion-card>
      <ion-card-content class="ion-text-center">
        <div class="ion-padding custom-skeleton">
          <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
          <ion-skeleton-text animated></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 88%"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 70%"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
        </div>
      </ion-card-content>
    </ion-card>
  </ion-grid>  

  <!-- MAPA CON POSICION ACTUAL -->
  <!-- <app-mapa [lat]="latitud" [lng]="longitud" *ngIf="latitud && longitud"></app-mapa> -->



  <!-- TENGO USUARIO  -->
  <ion-grid *ngIf="loadingUsuario" class="ion-no-padding">
    <ion-row>
      <ion-col>
        <ion-label color="danger" *ngIf="!usuario.status">We are reviewing your documentation</ion-label>
  

        <!-- SI TIENE UNA ENTREGA EN CURSO -->
        <ion-card *ngIf="deliveryActiva">
          <img src="../../../assets/delivery_OK.png" />
          <ion-card-header>
            <ion-card-subtitle color="pink" *ngIf="deliveryActiva.status_delivery == 1">Delivery In progress</ion-card-subtitle>
            <ion-card-subtitle color="primary" *ngIf="deliveryActiva.status_delivery == 2">Collecting</ion-card-subtitle>
            <ion-card-subtitle color="secondary" *ngIf="deliveryActiva.status_delivery == 3">Collected</ion-card-subtitle>
            <ion-card-subtitle color="primary" *ngIf="deliveryActiva.status_delivery == 4">In transit</ion-card-subtitle>
            <ion-card-subtitle color="success" *ngIf="deliveryActiva.status_delivery == 5">Delivered</ion-card-subtitle>
          </ion-card-header>

          <ion-card-content>
              <ion-button  (click)="verDelivery(deliveryActiva)" color="pink" expand='block'>Continue delivery.</ion-button>
          </ion-card-content>

        </ion-card>
        
        <div class="ion-text-center" *ngIf="!deliverys">
          <br><br><br>
          <img src="../../../assets/deliveryman_pink.png" />
          <h4 class="text-muted">You don't have any order pending!</h4>
        </div>

      </ion-col>
    </ion-row>


    <ion-row *ngIf="deliverys && loadingUsuario">
      <ion-col>

        <ion-card *ngFor="let pedido of deliverys" >
          <ion-card-header>
            <ion-card-subtitle class="text-big" color="primary"> {{ pedido.bussiness_name }} </ion-card-subtitle>
          </ion-card-header>
            <ion-item lines="none">
              <img src="../../../assets/icon/bebidas.png" slot="start" width="60">
              <ion-label class="ion-text-wrap">
                <p> {{ pedido.entrega_short_direccion | titlecase }} </p>
                <ion-button (click)="aceptarEntrega(pedido)" size="small" color="success">
                  <ion-icon name="checkmark-outline"></ion-icon>
                  Take
                </ion-button>
                <ion-button (click)="verDelivery(pedido)" size="small" color="goblue">
                  <ion-icon name="information-circle-outline"></ion-icon>
                  Detail
                </ion-button>
              </ion-label>
            </ion-item>

            <ion-row>
              <ion-col class="ion-padding ion-text-right">
                <ion-card-subtitle color="medium">{{ pedido.date_delivery | timeAgo }}</ion-card-subtitle>
              </ion-col>
            </ion-row>

        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>




</ion-content>
